Ext.define("NeoDoc.view.LoginWindow",{extend:"Ext.window.Window",alias:"widget.loginwindow",draggable:!1,height:195,width:400,resizable:!1,layout:{type:"fit"},closable:!1,title:"Login",modal:!0,initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"form",bodyPadding:30,frameHeader:!1,paramsAsHash:!0,waitTitle:"Logging in...",items:[{xtype:"textfield",anchor:"100%",fieldLabel:"Email",name:"email",inputType:"email",allowBlank:!1,allowOnlyWhitespace:!1},{xtype:"textfield",anchor:"100%",fieldLabel:"Password",name:"password",inputType:"password",allowBlank:!1,allowOnlyWhitespace:!1}],dockedItems:[{xtype:"toolbar",dock:"bottom",formBind:!1,ui:"footer",items:[{xtype:"tbspacer",flex:1},{xtype:"button",action:"login",formBind:!0,text:"Login"}]}]}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.MainTabPanel",{extend:"Ext.tab.Panel",alias:"widget.maintabpanel",headerPosition:"right",initComponent:function(){var e=this;e.callParent(arguments)}}),Ext.define("NeoDoc.view.MyPanel6",{extend:"Ext.panel.Panel",width:150,layout:{type:"fit"},title:"Networks",initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"treepanel",title:"My Tree Panel",viewConfig:{}}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.MyPanel7",{extend:"Ext.panel.Panel",layout:{type:"fit"},title:"Devices",initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"treepanel",title:"My Tree Panel",viewConfig:{}}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.MyViewport",{extend:"Ext.container.Viewport",requires:["NeoDoc.view.TreeTabPanel","NeoDoc.view.MainTabPanel"],layout:{type:"border"},initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"panel",region:"north",height:36,title:"NeoDoc",tools:[{xtype:"tool",action:"logout",tooltip:"Logout",type:"close"},{xtype:"tool",action:"refreshTree",tooltip:"Reload tree",type:"refresh"}]},{xtype:"toolbar",region:"south",height:37},{xtype:"treetabpanel",region:"west"},{xtype:"maintabpanel",region:"center"}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.TreeTabPanel",{extend:"Ext.tab.Panel",alias:"widget.treetabpanel",id:"treeTabPanel",itemId:"treeTabPanel",width:218,tabPosition:"left",initComponent:function(){var e=this;e.callParent(arguments)}}),Ext.define("NeoDoc.view.Viewport",{extend:"NeoDoc.view.MyViewport",renderTo:Ext.getBody()}),Ext.define("NeoDoc.view.device.CreateWindow",{extend:"Ext.window.Window",alias:"widget.devicecreatewindow",height:502,width:749,layout:{type:"card"},title:"New Device",maximizable:!0,modal:!0,initComponent:function(){var e=this;Ext.applyIf(e,{dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"button",itemId:"deviceCancelBtn",text:"Cancel"},{xtype:"tbfill"},{xtype:"button",disabled:!0,itemId:"devicePreviousBtn",text:"Previous",listeners:{click:{fn:e.onDevicePreviousBtnClick,scope:e}}},{xtype:"button",itemId:"deviceNextBtn",text:"Next",listeners:{click:{fn:e.onDeviceNextBtnClick,scope:e}}},{xtype:"tbspacer",width:20},{xtype:"button",action:"newdevice",disabled:!0,itemId:"deviceSubmitBtn",text:"Submit"}]}],items:[{xtype:"form",itemId:"newDevice-1",layout:{type:"fit"},bodyPadding:10,items:[{xtype:"fieldset",height:195,title:"Basic Information",items:[{xtype:"textfield",anchor:"100%",id:"device.name",itemId:"deviceName",fieldLabel:"Device Name",name:"name",allowBlank:!1},{xtype:"combobox",anchor:"100%",id:"device.type",itemId:"deviceType",fieldLabel:"Device Type",name:"deviceType",editable:!1,store:[["VM","VM"],["Physical","Physical"],["Switch","Switch"]],valueField:"name"},{xtype:"combobox",anchor:"100%",fieldLabel:"Manufacturer",name:"device.manufacturer"},{xtype:"combobox",anchor:"100%",fieldLabel:"Device Model",name:"device.model"},{xtype:"textfield",anchor:"100%",fieldLabel:"Device Serial nr",name:"device.serialnr"},{xtype:"textfield",anchor:"100%",fieldLabel:"Inventory Label",name:"device.label"},{xtype:"hiddenfield",anchor:"100%",itemId:"deviceParentId",fieldLabel:"Label",name:"pid"},{xtype:"hiddenfield",anchor:"100%",itemId:"deviceCallerId",fieldLabel:"Label",name:"callerid"},{xtype:"hiddenfield",anchor:"100%",itemId:"csrf_token",fieldLabel:"Label",name:"authenticity_token"}]}]},{xtype:"form",itemId:"newDevice-3",layout:{type:"fit"},bodyPadding:10,items:[{xtype:"fieldset",border:0,height:215,width:559,layout:{type:"fit"},items:[{xtype:"label",text:"Confirm that the information below is correct:"},{xtype:"displayfield",border:2,height:334,itemId:"newDeviceSummary"}]}]}]}),e.callParent(arguments)},onDevicePreviousBtnClick:function(e){var t=this.getLayout().activeItem.itemId,i=t.split("newDevice-")[1],o=this.down("#deviceNextBtn");if(this.down("#newDevice-1"),console.log("prev btn clicked, "+i),console.log("next btn = "+o.itemId),console.log("this.itemID="+this.itemId),i>1){var n=parseInt(i,10)-1;o.setDisabled(!1),console.log("Setting activeItem to newDevice-"+n),this.layout.setActiveItem("newDevice-"+n),1===n?e.setDisabled(!0):e.setDisabled(!1)}},onDeviceNextBtnClick:function(e){var t=this.getLayout().activeItem.itemId,i=t.split("newDevice-")[1],o=this.down("#devicePreviousBtn"),n=this.down("#deviceSubmitBtn"),a=this.down("#newDevice-1").getForm();if(a.isValid()){console.log("Next btn clicked, activeitem="+i),console.log("Prev btn = "+o.itemId),console.log("this.itemID="+this.itemId);var d=this.down("#deviceType").getValue();console.log("DeviceType Selected="+d);var l=parseInt(i,10)+1;switch(d){case"VM":if(2==l){if(this.getComponent("newDevice-"+l))var r=this.getComponent("newDevice-"+l);else var r=Ext.create("NeoDoc.view.device.newVMForm",{itemId:"newDevice-"+l,cls:"Device"});o.setDisabled(!1),console.log("Setting activeItem to newDevice-"+l),this.layout.setActiveItem(r)}if(3===l){var c=this.down("#newDeviceSummary"),s=this.down("#newDevice-2").getForm(),m="<b>Name:</b> "+a.findField("device.name").getValue()+"<br>"+"<b>Type:</b> "+a.findField("device.type").getValue()+"<br>"+"<b>OS: </b> "+s.findField("device.vm.os").rawValue+"<br>";c.setValue(m),e.setDisabled(!0),n.setDisabled(!1),this.layout.setActiveItem("newDevice-"+l)}else e.setDisabled(!1),n.setDisabled(!0)}}}}),Ext.define("NeoDoc.view.device.FolderGrid",{extend:"Ext.grid.Panel",alias:"widget.devicefoldergrid",height:250,id:"DevFolderTab-Grid",itemId:"devfoldertabgrid",width:867,collapsible:!1,title:"My Grid Panel",emptyText:"No devices availble for this location",initComponent:function(){var e=this;Ext.applyIf(e,{columns:[{xtype:"gridcolumn",width:108,dataIndex:"name",groupable:!1,text:"Device"},{xtype:"gridcolumn",dataIndex:"devicetype",text:"Device Type"},{xtype:"gridcolumn",dataIndex:"model",text:"Model"},{xtype:"gridcolumn",dataIndex:"serialnr",text:"Serial Number"},{xtype:"gridcolumn",dataIndex:"label",text:"Label"},{xtype:"datecolumn",dataIndex:"created_at",text:"Created At"},{xtype:"datecolumn",dataIndex:"updated_at",text:"Updated At"},{xtype:"gridcolumn",dataIndex:"updated_by",text:"Updated By"},{xtype:"gridcolumn",dataIndex:"created_by",text:"Created By"},{xtype:"actioncolumn",items:[{disabled:!0}]}],viewConfig:{id:"FolderGridView",itemId:"FolderGridView"}}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.device.FolderTreeGrid",{extend:"Ext.tree.Panel",alias:"widget.devicefoldertreegrid",height:250,id:"DeviceFolderTabGrid",itemId:"DeviceFolderTabGrid",width:400,collapsible:!1,header:!1,title:"Devices",columnLines:!1,folderSort:!1,lines:!1,rootVisible:!1,initComponent:function(){var e=this;Ext.applyIf(e,{viewConfig:{},columns:[{xtype:"treecolumn",dataIndex:"devicetype",text:"Device Type",flex:1},{xtype:"gridcolumn",dataIndex:"name",text:"Device"},{xtype:"gridcolumn",text:"MyColumn5"},{xtype:"gridcolumn",text:"MyColumn7"}],features:[{ftype:"rowbody",getAdditionalData:function(e,t,i){console.log("In getAdditionalData"),console.log(i)}}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.device.GeneralPanel",{extend:"Ext.panel.Panel",height:199,width:629,resizable:!0,initComponent:function(){var e=this;Ext.applyIf(e,{tpl:['<div class="post-data">','    <span class="post-date">Last updated by {updated_by} at {updated_at}</span>','    <h3 class="post-title"><b>Device Name:</b> {name}</h3><br>',"    <b>Type: </b> {devicetype}<br>","    <b>Serial number:</b> {serialnr}<br>","	<b>Model:</b> {model}<br>","    <b>Label:</b> {label}<br>","</div>","<p>",'    <div class="post-body"><b>Description:</b><p>{description}</div>']}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.device.GeneralView",{extend:"Ext.view.View",alias:"widget.devicegeneralview",height:250,id:"networkgeneralview1",itemId:"networkgeneralview",padding:10,width:400,itemSelector:"div",initComponent:function(){var e=this;Ext.applyIf(e,{itemTpl:["<h1>General Information</h1>","<p>","","    <b>Network Name:</b> {network_name}<br>","    <b>Network:</b> {netmask}<br>","    <b>Gateway:</b> {gateway}<br>","   	<b>VLAN ID:</b> {vlanid}<br>","    ","<p>","    <b>Description</b><p>","        ","    {description}","</p>"]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.device.MainTabPanel",{extend:"Ext.tab.Panel",alias:"widget.devicemaintabpanel",height:686,width:742,initComponent:function(){var e=this;e.callParent(arguments)}}),Ext.define("NeoDoc.view.device.NetworkInfoPanel",{extend:"Ext.panel.Panel",height:375,width:629,resizable:!0,layout:{type:"border"},initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"gridpanel",region:"north",height:150,id:"DeviceNetworkIpTabGrid1",itemId:"DeviceNetworkIpTabGrid1",autoScroll:!0,header:!1,columns:[{xtype:"gridcolumn",width:126,defaultWidth:140,sortable:!1,dataIndex:"ipv4",text:"IP"},{xtype:"gridcolumn",width:166,dataIndex:"description",text:"Description"},{xtype:"gridcolumn",dataIndex:"status",groupable:!0,text:"Status"},{xtype:"gridcolumn",width:134,dataIndex:"network.network_name",text:"Network"}]},{xtype:"panel",region:"center",id:"devicenetworkgeneralinfo",itemId:"devicenetworkgeneralinfo",tpl:["<h1>General Information</h1>","<p>","","    <b>Network Name:</b> {network_name}<br>","    <b>Network:</b> {netmask}<br>","    <b>Gateway:</b> {gateway}<br>","   	<b>VLAN ID:</b> {vlanid}<br>","    ","<p>","    <b>Description</b><p>","        ","    {description}","</p>"],title:"My Panel"}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.device.newVMForm",{extend:"Ext.form.Panel",alias:"widget.devicenewvmform",height:504,id:"deviceNewVMForm",itemId:"deviceNewVMForm",padding:"",width:719,bodyPadding:10,initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"fieldset",height:50,layout:{type:"hbox"},title:"Operating System",items:[{xtype:"combobox",formBind:!1,id:"device.vm.os",width:336,fieldLabel:"OS:",name:"operatingsystem",size:40,editable:!1,displayField:"name",store:"OperatingSystemStore",valueField:"id",listeners:{select:{fn:e.onosSelect,scope:e}}},{xtype:"combobox",disabled:!0,id:"device.vm.osversion",itemId:"devicevmosversion",padding:"0 0 0 10",fieldLabel:"Version",labelWidth:50,name:"version",editable:!1,displayField:"name",store:"VersionStore",valueField:"id"}]},{xtype:"fieldset",height:164,id:"device.vm.parts",padding:5,autoScroll:!0,resizable:!0,layout:{columns:2,type:"table"},title:"Devices",items:[{xtype:"numberfield",id:"device.vm.memory",fieldLabel:"Memory",name:"memory",value:1},{xtype:"combobox",id:"device.vm.memmetric",padding:"0 0 0 5",name:"memmetric",value:["GB","GB"],size:5,editable:!1,queryMode:"local",store:[["MB","MB"],["GB","GB"],["TB","TB"]],valueField:"name"},{xtype:"numberfield",id:"device.vm.cpu",fieldLabel:"Processors",name:"cpu",value:1,maxValue:8,minValue:1},{xtype:"numberfield",id:"device.vm.cores",padding:"0 0 0 5",fieldLabel:"Cores",name:"cores",value:1,decimalPrecision:0,maxValue:8,minValue:1},{xtype:"numberfield",id:"device.vm.hdd1",fieldLabel:"Hard Disk 1",name:"hdd1",value:32,minValue:0},{xtype:"combobox",id:"device.vm.hddmetric1",padding:"0 0 0 5",name:"hddmetric1",value:["GB","GB"],size:5,editable:!1,queryMode:"local",store:[["MB","MB"],["GB","GB"],["TB","TB"]],valueField:"name"}]},{xtype:"splitbutton",id:"device.vm.addpartbtn",text:"Add Field",menu:{xtype:"menu",width:120,items:[{xtype:"menuitem",id:"device.vm.addhddbtn",text:"Add Harddisk",listeners:{click:{fn:e.onaddhddbtnClick,scope:e}}},{xtype:"menuitem",id:"device.vm.addnetbtn",text:"Add Network",listeners:{click:{fn:e.onaddnetbtnClick,scope:e}}}]}},{xtype:"fieldset",title:"Description",items:[{xtype:"htmleditor",anchor:"100%",formBind:!0,height:150,id:"device.vm.description",name:"description"}]}]}),e.callParent(arguments)},onosSelect:function(e,t){console.log("In onosSelect"),console.log(t);var i=this.down("#devicevmosversion"),o=i.getStore();o.getProxy().extraParams.whattoget="osversioninfo",o.getProxy().extraParams.osid=e.getValue(),o.reload(),o.on("load",function(){i.setDisabled(!1),i.setValue(o.first().data.id)})},onaddhddbtnClick:function(){console.log("in onaddhddbtnClick");for(var e=this.getForm(),t=Ext.getCmp("device.vm.parts"),i=2,o=e.findField("hdd"+i);o;)console.log("Found hdd"+i),i++,o=e.findField("hdd"+i);if(console.log("Found "+(i-1)+" hdd fields"),32>i){var n=new Ext.form.NumberField({xtype:"numberfield",id:"device.vm.hdd"+i,fieldLabel:"Hard Disk "+i,name:"hdd"+i,value:32,minValue:0}),a=new Ext.form.ComboBox({xtype:"combobox",id:"device.vm.hddmetric"+i,padding:"0 0 0 5",name:"hddmetric"+i,value:["GB","GB"],size:5,editable:!1,queryMode:"local",store:[["MB","MB"],["GB","GB"],["TB","TB"]],valueField:"name"});t.insert(n),t.insert(a)}},onaddnetbtnClick:function(){}}),Ext.define("NeoDoc.view.location.CreateWindow",{extend:"Ext.window.Window",alias:"widget.newlocationwindow",height:461,width:666,layout:{type:"fit"},title:"New Location",modal:!0,initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"form",layout:{align:"stretch",type:"hbox"},bodyPadding:10,header:!1,dockedItems:[{xtype:"container",flex:1,dock:"top",height:121,padding:10,layout:{type:"anchor"},items:[{xtype:"textfield",anchor:"100%",fieldLabel:"Name",name:"name",tabIndex:1,allowBlank:!1,allowOnlyWhitespace:!1},{xtype:"textareafield",anchor:"100%",fieldLabel:"Address",name:"address"}]},{xtype:"toolbar",flex:1,dock:"bottom",formBind:!0,items:[{xtype:"button",text:"Reset"},{xtype:"tbspacer",flex:1},{xtype:"button",text:"Cancel"},{xtype:"button",action:"locationcreate",text:"Create"}]}],items:[{xtype:"container",padding:10,width:297,layout:{type:"anchor"},items:[{xtype:"combobox",anchor:"100%",fieldLabel:"Country",name:"country",displayField:"name",queryMode:"local",store:"countryStore"},{xtype:"textfield",anchor:"100%",fieldLabel:"Longitude",name:"longitude"},{xtype:"textfield",anchor:"100%",fieldLabel:"Latitude",name:"latitude"},{xtype:"textfield",anchor:"100%",fieldLabel:"Url",name:"url",inputType:"url"}]},{xtype:"container",flex:1,layout:{type:"anchor"},items:[{xtype:"textareafield",height:216,padding:10,width:327,fieldLabel:"Description",name:"description"}]}]}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.location.Treetab",{extend:"Ext.panel.Panel",alias:"widget.locationtreetab",width:114,layout:{type:"fit"},header:!1,title:"Location",initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"treepanel",cls:"location-list",id:"locationTreePanel",itemId:"locationTreePanel",width:150,collapsed:!1,header:!1,store:"navTreeStore",rootVisible:!1,viewConfig:{}}],dockedItems:[{xtype:"toolbar",dock:"bottom",items:[{xtype:"button",action:"newlocation",id:"newLocationBtn",itemId:"newLocationBtn",text:"New Location"}]}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.network.CreateWindow",{extend:"Ext.window.Window",alias:"widget.networkcreatewindow",height:470,width:716,layout:{type:"card"},title:"New network",initComponent:function(){var e=this;Ext.applyIf(e,{items:[{xtype:"form",itemId:"newNetworkForm",bodyPadding:10,url:"/networks.json",items:[{xtype:"fieldset",height:380,title:"Details",items:[{xtype:"combobox",anchor:"100%",fieldLabel:"Location",name:"networkLocation"},{xtype:"textfield",anchor:"100%",id:"networkName",fieldLabel:"Network Name",name:"network_name",allowBlank:!1,emptyText:"Network name",growMax:256,maxLength:256,minLength:3},{xtype:"textfield",anchor:"100%",itemId:"networkNetwork",fieldLabel:"Network",name:"network",allowBlank:!1,emptyText:"Network base address",regex:/(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/},{xtype:"numberfield",anchor:"100%",itemId:"networkVlanID",fieldLabel:"VLAN ID",name:"vlanid",decimalPrecision:0,maxValue:4096,minValue:0},{xtype:"textfield",anchor:"100%",itemId:"networkNetmask",fieldLabel:"Netmask",name:"netmask",allowBlank:!1,emptyText:"xxx.yyy.zzz.qqq",regex:/(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/},{xtype:"textfield",anchor:"100%",itemId:"networkGateway",fieldLabel:"Gateway",name:"gateway",emptyText:"xxx.yyy.zzz.qqq",regex:/(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/},{xtype:"checkboxfield",anchor:"100%",itemId:"networkCreateIpnumbers",hideEmptyLabel:!1,name:"createip",boxLabel:"Automatically create IPnumber Nodes",checked:!0},{xtype:"htmleditor",anchor:"100%",height:150,itemId:"networkDescription",style:"background-color: white;",fieldLabel:"Description",name:"description"},{xtype:"hiddenfield",anchor:"100%",itemId:"networkParentId",name:"pid"}]}],dockedItems:[{xtype:"toolbar",dock:"bottom",formBind:!1,items:[{xtype:"button",formBind:!1,text:"Reset"},{xtype:"tbspacer",flex:1},{xtype:"button",handler:function(){this.destory()},id:"networkCancelBtn",text:"Cancel"},{xtype:"button",action:"newnetwork",formBind:!0,itemId:"networkCreateBtn",text:"Create..."}]}]}]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.network.GeneralPanel",{extend:"Ext.panel.Panel",height:250,width:400,initComponent:function(){var e=this;e.callParent(arguments)}}),Ext.define("NeoDoc.view.network.GeneralView",{extend:"Ext.view.View",alias:"widget.networkgeneralview",height:250,id:"networkgeneralview",itemId:"networkgeneralview",padding:10,width:400,itemSelector:"div",initComponent:function(){var e=this;Ext.applyIf(e,{itemTpl:["<h1>General Information</h1>","<p>","","    <b>Network Name:</b> {network_name}<br>","    <b>Network:</b> {netmask}<br>","    <b>Gateway:</b> {gateway}<br>","   	<b>VLAN ID:</b> {vlanid}<br>","    ","<p>","    <b>Description</b><p>","        ","    {description}","</p>"]}),e.callParent(arguments)}}),Ext.define("NeoDoc.view.network.IpNumberGrid",{extend:"Ext.grid.Panel",id:"NetworkIpTabGrid",itemId:"NetworkIpTabGrid",autoScroll:!0,header:!1,initComponent:function(){var e=this;Ext.applyIf(e,{features:[{ftype:"grouping",groupByText:"status",startCollapsed:!0}],columns:[{xtype:"gridcolumn",width:126,defaultWidth:140,sortable:!1,dataIndex:"ipv4",text:"IP"},{xtype:"gridcolumn",width:166,dataIndex:"description",text:"Description",editor:{xtype:"textareafield",name:"description"}},{xtype:"gridcolumn",dataIndex:"status",groupable:!0,text:"Status",editor:{xtype:"combobox",name:"statusfield",allowBlank:!1,allowOnlyWhitespace:!1,editable:!1,queryMode:"local",store:"IpStatusStore",valueField:"name"}},{xtype:"gridcolumn",width:134,dataIndex:"devicename",text:"Device"},{xtype:"datecolumn",dataIndex:"updated_at",text:"Last Updated"},{xtype:"gridcolumn",dataIndex:"updated_by",text:"Last Updated By"},{xtype:"actioncolumn",dataIndex:"action",items:[{}]}],plugins:[Ext.create("Ext.grid.plugin.CellEditing",{})],listeners:{itemcontextmenu:{fn:e.onNetworkIpTabGridItemContextMenu,scope:e}}}),e.callParent(arguments)},onNetworkIpTabGridItemContextMenu:function(e,t,i,o,n){var a,d,l,r=!1;switch(console.log("In Grid Context Menu"),console.log("With record.data.id="+t.data.id),console.log("With record.data.status="+t.data.status),t.data.status){case"Available":r=!0;var c=this.id;l=new Ext.menu.Menu({itemid:"networkAvailableMenu",items:[{xtype:"menuitem",text:"Add Device...",itemid:"networkMenuNewDevice",handler:function(){var e=Ext.create("NeoDoc.view.device.CreateWindow",{}),i=e.down("#deviceParentId"),o=e.down("#deviceCallerId");i.setValue(t.data.id),o.setValue(c),e.show()}},{xtype:"menuitem",text:"New Document...",action:"onCreateDocument",itemid:"documentMenuNewNetwork",disabled:!0}]});break;case"Gateway":r=!0,l=new Ext.menu.Menu({itemid:"networkGatewayMenu",items:[{xtype:"menuitem",text:"Add Device...",itemid:"networkMenuNewDevice",handler:function(){var e=Ext.create("NeoDoc.view.device.CreateWindow",{}),i=e.down("#deviceParentId"),o=e.down("#deviceCallerId");i.setValue(t.data.id),o.setValue(this.id),e.show()}},{xtype:"menuitem",text:"New Document...",action:"onCreateDocument",itemid:"documentMenuNewNetwork",disabled:!0}]})}r&&(a=n.browserEvent.clientX,d=n.browserEvent.clientY,console.log("X="+a),console.log("Y="+d),l.showAt(n.getXY()),n.stopEvent())}}),Ext.define("NeoDoc.view.network.IpNumberPanel",{extend:"Ext.panel.Panel",autoScroll:!0,layout:{type:"fit"},title:"Ipnumbers",initComponent:function(){var e=this;e.callParent(arguments)}}),Ext.define("NeoDoc.view.network.MainTabPanel",{extend:"Ext.tab.Panel",alias:"widget.networkmaintabpanel",height:686,width:742,initComponent:function(){var e=this;e.callParent(arguments)}}),Ext.define("NeoDoc.controller.Authentication",{extend:"Ext.app.Controller",refs:[{ref:"viewport",selector:"viewport"},{ref:"loginWindow",selector:"loginwindow"},{ref:"loginForm",selector:"loginwindow formpanel"}],init:function(e){var t=this;console.log("In init");var i=localStorage.getItem("neodocUser");if(console.log(localStorage),console.log("CurrentUserBase:",i),localStorage.getItem("neodocUser")&&(console.log("Verifying session"),Ext.Ajax.request({url:"/api/users/verify",headers:{Accept:"application/vnd.neodocapi.v1"},method:"POST",params:{},jsonData:{},success:function(){console.log("Current User is properly logged in")},failure:function(e){console.log("Current User is not properly logged in"),console.log(e),localStorage.removeItem("neodocUser"),i=null,window.location.reload()}})),console.log("CurrentUserBase:",i),null===i){var o=Ext.create("NeoDoc.view.LoginWindow",{});o.show()}else t.currentUser=Ext.decode(i),t.application.fireEvent("loggedin",t.currentUser);this.control({"loginwindow button[action=login]":{click:this.onLoginClick},"tool[action=logout]":{click:this.onLogoutClick}}),e.on({loggedin:{fn:this.onLoggedin,scope:this}})},authenticateUser:function(e){var t=this,i=this.getLoginWindow(),o=i.items.items[0].getForm();i.setLoading("logging in..."),Ext.Ajax.request({url:"/api/users/sign_in",headers:{Accept:"application/vnd.neodocapi.v1"},method:"POST",params:{},jsonData:e,success:function(e){var n=o.findField("password"),a=o.findField("email");n.setValue(""),a.setValue("");var d=e.responseText,l=Ext.decode(d),r={auth_token:l.auth_token,email:l.email,role:Ext.decode(l.role)};localStorage.setItem("neodocUser",Ext.encode(r)),t.currentUser=r,i.hide(),t.application.fireEvent("loggedin",t.currentUser)},failure:function(e){console.log(e),i.setLoading(!1),Ext.Msg.alert("Login Error","The email-password combination is invalid")}})},onLoginClick:function(){var e=this,t=this.getLoginWindow(),i=t.items.items[0].getForm();console.log("In onLoginClick");var o=i.findField("email"),n=i.findField("password");console.log("email:",o),e.authenticateUser({user_login:{email:o.getValue(),password:n.getValue()}},null)},onLogoutClick:function(){var e=this;e.getViewport().setLoading("Logging out..."),e.destroyAuthentication()},destroyAuthentication:function(){var e=this;e.getViewport().setLoading("Logging out.."),console.log("Logging out..."),Ext.Ajax.request({url:"/api/users/sign_out",method:"DELETE",headers:{Accept:"application/vnd.neodocapi.v1"},params:{},jsonData:{},success:function(){e.currentUser=null,localStorage.removeItem("neodocUser"),window.location.reload()},failure:function(){e.getViewport().setLoading(!1),Ext.Msg.alert("Logout Error","Can't Logout")}})},onLoggedin:function(){console.log("in authentication loggedin")},onRefreshClick:function(){var e=Ext.StoreMgr.get("navTreeStore");e.load()}}),Ext.define("NeoDoc.controller.Device",{extend:"Ext.app.Controller",refs:[{ref:"deviceCreateWindow",selector:"devicecreatewindow"},{ref:"MainTabPanel",selector:"maintabpanel"},{ref:"deviceMainTab",selector:"devicemaintab"},{ref:"devfoldertabgrid",selector:"DevFolderTab-Grid"}],onCreateDevice:function(){console.log("In onCreateDevice");var e=this.getDeviceCreateWindow(),t=e.down("#newDevice-1").getForm(),i=e.down("#newDevice-2").getForm();t.isValid()&&i.isValid()&&(e.setLoading("Submitting..."),Ext.Ajax.request({url:"/api/devices",params:Ext.encode({formData1:t.getValues(),formData2:i.getValues()}),headers:{Accept:"application/vnd.neodocapi.v1"},method:"POST",success:function(t,i){Ext.Msg.alert("Created device successfully!"),e.setLoading(!1),e.destroy();var o=Ext.getCmp(JSON.parse(i.params).formData1.callerid);o.setLoading(!0),o.getStore().reload(),o.setLoading(!1)},failure:function(t){Ext.Msg.alert("Failed to create device!\n\n"+t),e.setLoading(!1)}}))},onGridpanelItemDblClick:function(e,t){console.log("Double click"),console.log(t);var i=this.getMainTabPanel(),o=i.activeTab,n=o.getChildByElement("DeviceTab-GeneralPanel-"+t.data.id);if(n)i.setActiveTab(n);else{var a=Ext.create("Ext.panel.Panel",{title:"Device - "+t.data.name,id:"DeviceTab-GeneralPanel-"+t.data.id,itemId:"DeviceTab-GeneralPanel-"+t.data.id,cls:"Device"}),d=Ext.create("NeoDoc.view.device.GeneralPanel",{title:"General Info",id:"DeviceTab-GeneralInfoPanel-"+t.data.id,itemId:"DeviceTab-GeneralInfoPanel-"+t.data.id,cls:"Device",padding:10,width:500,height:300,resizeable:!0});if(a.add(d),t.data.ipnumbers){var l=function(){return Ext.create("Ext.data.Store",{model:"NeoDoc.model.device.IpnumbersGrid",data:t.data.ipnumbers,idProperty:"id",root:"ipnumbers"})},r=Ext.create("NeoDoc.view.device.NetworkInfoPanel",{title:"Network Info",id:"DeviceTab-NetworkInfoPanel-"+t.data.id,itemId:"DeviceTab-NetworkInfoPanel-"+t.data.id,cls:"Device",padding:10,resizeable:!0,store:l()});a.add(r)}a.add(Ext.create("Ext.panel.Panel",{title:"Comments",id:"DeviceTab-GeneralTestPanel-"+t.data.id,itemId:"DeviceTab-GeneralTestPanel-"+t.data.id,cls:"Device",padding:10,width:400,height:200})),a.add(Ext.create("Ext.panel.Panel",{title:"Related documents",id:"DeviceTab-GeneralDocumentPanel-"+t.data.id,itemId:"DeviceTab-GeneralDocumentPanel-"+t.data.id,cls:"Device",padding:10,width:400,height:200})),d.data=t.data,d.update(t.data),o.add(a),o.setActiveTab(a)}},onNewdevicetab:function(e){console.log("in onNewdevicetab"),console.log(e);var t=this;t.getMainTabPanel()},onNewdevicefoldertab:function(e){var t=this,i=t.getMainTabPanel();console.log("in onNewdevicefoldertab"),console.log(e);var o=Ext.create("NeoDoc.store.DeviceFolderStore");o.storeId="DeviceFolderStore-"+e.parentId,o.defaultRootId=e.parentId,console.log("panelId=DevFolderTab-"+e.parentId);var n=i.getChildByElement("DevFolderTab-"+e.parentId);if(n)i.setActiveTab(n);else{var a=Ext.create("NeoDoc.view.network.MainTabPanel",{title:"Devices - "+e.parentName,id:"DevFolderTab-"+e.parentId,itemId:"DevFolderTab-"+e.parentId,cls:"DeviceFolder",closable:!0});Ext.define("NeoDoc.view.device.override.FolderGrid",{override:"NeoDoc.view.device.FolderGrid",plugins:[{ptype:"rowexpander",rowBodyTpl:new Ext.XTemplate('<span><p><b>OS:</b><tpl for="operatingsystem">{name}</tpl> <tpl for="osversion">{name}</tpl></p></span>','<span><b>IP Address:</b> <tpl for="ipnumbers">{ipv4}</tpl></span>')}]});var d=Ext.create("NeoDoc.view.device.FolderGrid",{title:"All Devices",id:"DevFolderTab-Grid"+e.parentId,cls:"DeviceFolder",store:o,closable:!1,dockedItems:[{xtype:"pagingtoolbar",dock:"bottom",width:360,displayInfo:!0,store:o}]});o.getProxy().extraParams.whattoget="getlocationdevices",o.getProxy().extraParams.locationid=e.parentId,o.loadPage(1),a.add(d),i.add(a),i.setActiveTab(a)}},onItemDblClick:function(e,t){console.log("In Item Dbl Click with record "+t),this.getBubbleParent()},init:function(e){this.control({"devicecreatewindow button[action=newdevice]":{click:this.onCreateDevice},"#devfoldertabgrid":{itemdblclick:this.onGridpanelItemDblClick}}),e.on({newdevicetab:{fn:this.onNewdevicetab,scope:this},newdevicefoldertab:{fn:this.onNewdevicefoldertab,scope:this}})}}),Ext.define("NeoDoc.controller.Location",{extend:"Ext.app.Controller",stores:["navTreeStore"],refs:[{ref:"newLocationWindow",selector:"newlocationwindow"},{ref:"locationTreeTab",selector:"locationtreetab"},{ref:"locationTreePanel",selector:"locationtreepanel"},{ref:"treeTabPanel",selector:"treetabpanel"}],onLocationNewBtn:function(){console.log("In onLocationNewBtn");var e=Ext.create("NeoDoc.view.location.CreateWindow",{});e.show()},onCreateLocation:function(){console.log("In onCreateLocation");var e=this.getNewLocationWindow(),t=e.items.items[0].getForm(),i=t.findField("name");console.log("name:",i),t.isValid()&&(e.setLoading("Submitting..."),t.submit({url:"/api/locations",headers:{Accept:"application/vnd.neodocapi.v1"},method:"POST",success:function(){Ext.Msg.alert("Created location successfully!");var t=Ext.StoreMgr.get("navTreeStore");t.load(),e.setLoading(!1),e.destroy()},failure:function(t){Ext.Msg.alert("Failed to create location!\n\n"+t),e.setLoading(!1)}}))},onTreepanelSelect:function(e,t){var i=this;switch(console.log("In TreePanelSelect"),console.log("Record cls is "+t.get("cls")),t.get("cls")){case"Network":console.log("Adding network tab"),i.application.fireEvent("newnetworktab",t.data);break;case"Device":console.log("Adding device tab"),i.application.fireEvent("newdevicetab",t.data);break;case"DeviceFolder":console.log("Adding devicefolder tab"),i.application.fireEvent("newdevicefoldertab",t.data)}},onTreepanelItemContextMenu:function(e,t,i,o,n){var a,d,l,r=!1;switch(console.log("IN context menu"),console.log("Clicked Item is of class: "+t.get("cls")),t.get("cls")){case"Location":r=!0,l=new Ext.menu.Menu({itemid:"locationMenu",items:[{xtype:"menuitem",text:"New Network...",itemid:"locationMenuNewNetwork",handler:function(){var e=Ext.create("NeoDoc.view.network.CreateWindow",{}),i=e.down("#networkParentId");i.setValue(t.get("id")),e.show()}},{xtype:"menuitem",text:"New Document...",action:"onCreateDocument",itemid:"documentMenuNewNetwork",disabled:!0}]})}r&&(a=n.browserEvent.clientX,d=n.browserEvent.clientY,console.log("X="+a),console.log("Y="+d),l.showAt(n.getXY()),n.stopEvent())},onLoggedin:function(){console.log("In location onLoggedin"),Ext.create("NeoDoc.view.MyViewport");var e=this.getTreeTabPanel(),t=Ext.create("NeoDoc.view.location.Treetab",{}),i=e.add(t);e.setActiveTab(i)},init:function(e){this.control({"locationtreetab button[action=newlocation]":{click:this.onLocationNewBtn},"newlocationwindow button[action=locationcreate]":{click:this.onCreateLocation},treepanel:{select:this.onTreepanelSelect,itemcontextmenu:this.onTreepanelItemContextMenu}}),e.on({loggedin:{fn:this.onLoggedin,scope:this}})}}),Ext.define("NeoDoc.controller.Network",{extend:"Ext.app.Controller",refs:[{ref:"networkCreateWindow",selector:"networkcreatewindow"},{ref:"networkMainTab",selector:"networkmaintabpanel"},{ref:"MainTabPanel",selector:"maintabpanel"}],onCreateNetwork:function(){console.log("In onCreateNetwork");var e=this.getNetworkCreateWindow(),t=e.items.items[0].getForm(),i=t.findField("name");console.log("name:",i),t.isValid()&&(e.setLoading("Submitting..."),t.submit({url:"/api/networks",headers:{Accept:"application/vnd.neodocapi.v1"},method:"POST",success:function(){Ext.Msg.alert("Created network successfully!");var t=Ext.StoreMgr.get("navTreeStore");t.load(),e.setLoading(!1),e.destroy()},failure:function(t){Ext.Msg.alert("Failed to create network!\n\n"+t),e.setLoading(!1)}}))},onNewnetworktab:function(e){var t=this,i=t.getMainTabPanel(),o=Ext.create("NeoDoc.store.IpnumberStore");o.storeid="Network-IpStore-"+e.id,netstore=Ext.create("NeoDoc.store.NetworkInfoStore"),netstore.storeid="Network-IpInfoStore-"+e.id,console.log("In onNewnetworkTab"),console.log("panelId=NetworkTab-"+e.id);var n=i.getChildByElement("NetworkTab-"+e.id);if(n)i.setActiveTab(n);else{var a=Ext.create("NeoDoc.view.network.MainTabPanel",{title:"Network - "+e.text,id:"NetworkTab-"+e.id,itemId:"NetworkTab-"+e.id,cls:"Network",closable:!0});netstore.getProxy().extraParams.whattoget="generalinfo",netstore.getProxy().extraParams.networkid=e.id,netstore.load();var d=Ext.create("NeoDoc.view.network.GeneralPanel",{title:"General",id:"NetworkTab-GeneralPanel"+e.id,itemId:"NetworkTab-GeneralPanel"+e.id,cls:"Network",closable:!1}),l=Ext.create("NeoDoc.view.network.GeneralView",{title:"General",id:"NetworkTab-GeneralView"+e.id,itemId:"NetworkTab-GeneralView"+e.id,cls:"Network",store:netstore,closable:!1});d.add(l),d.add(Ext.create("Ext.panel.Panel",{title:"Comments",id:"NetworkTab-GeneralTestPanel"+e.id,itemId:"NetworkTab-GeneralTestPanel"+e.id,cls:"Network",padding:10,width:400,height:200})),d.add(Ext.create("Ext.panel.Panel",{title:"Documents",id:"NetworkTab-GeneralDocumentPanel"+e.id,itemId:"NetworkTab-GeneralDocumentPanel"+e.id,cls:"Network",padding:10,width:400,height:200}));
var r=Ext.create("NeoDoc.view.network.IpNumberPanel",{title:"IpNumbers",id:"NetworkTab-Ipnumber"+e.id,itemId:"NetworkTab-Ipnumber"+e.id,cls:"Network",closable:!1}),c=Ext.create("NeoDoc.view.network.IpNumberGrid",{title:"IpNumberGrid",id:"NetworkTab-IpnumberGrid"+e.id,itemId:"NetworkTab-IpnumberGrid"+e.id,cls:"Network",store:o,closable:!1,dockedItems:[{xtype:"pagingtoolbar",dock:"bottom",displayInfo:!0,store:o}]});o.getProxy().extraParams.whattoget="getiplist",o.getProxy().extraParams.networkid=e.id,o.loadPage(1),r.add(c),a.add(d),a.add(r),i.add(a),i.setActiveTab(a),a.setActiveTab(d)}},init:function(e){this.control({"networkcreatewindow button[action=newnetwork]":{click:this.onCreateNetwork}}),e.on({newnetworktab:{fn:this.onNewnetworktab,scope:this}})}}),Ext.Loader.setConfig({enabled:!0}),Ext.application({models:["locationTreeModel","network.IpModel","network.InfoModel","device.IpnumbersGrid"],stores:["countryStore","IpnumberStore","IpStatusStore","NetworkInfoStore","OperatingSystemStore","DeviceTypeStore","VersionStore"],views:["MyViewport","LoginWindow","TreeTabPanel","MainTabPanel"],autoCreateViewport:!1,controllers:["Authentication","Location","Network","Device"],name:"NeoDoc",appFolder:"/assets/app",namespaces:["neodoc"]}),Ext.onReady(function(){Ext.Ajax.on("beforerequest",function(e,t){var i=Ext.decode(localStorage.getItem("neodocUser"));if(null!==i){var o=i.auth_token;Ext.Ajax.extraParams={auth_token:o}}var n,a;return a=Ext.select('meta[name="csrf-token"]'),null!=a.first()?(n=a.first().dom.content,t.headers||(t.headers={}),t.headers["X-CSRF-Token"]=n):void 0},this)});